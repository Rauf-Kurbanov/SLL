div(x, y) = mul(mul(sgn(x), sgn(y)), dnn(abs(x), abs(y)))
dnn(x, y) = dnn2(lss(x, y), x, y)
hslengths(n) = hslengths2(n, S(Z), Nil)
hsnext(n) = cnd(isz(mod(n, S(S(Z)))), mul(S(n), S(S(S(Z)))), dnn(n, S(S(Z))))
lss(x, y) = isn(sub(x, y))
mod(x, y) = sub(x, mul(div(x, y), y))
sort(a) = maybehead(sortiters(listup(a)))
sub(x, y) = add(x, neg(y))
take(n, list) = takehelper(n, list, Nil)
abs(N(x)) = x
abs(S(x)) = S(x)
abs(Z) = Z
add(N(x), y) = sup(y, x)
add(S(x), y) = aup(y, S(x))
add(Z, y) = y
aup(N(x), y) = snn(y, x)
aup(S(x), y) = S(aup(x, y))
aup(Z, y) = y
cnd(F, t1, f1) = f1
cnd(T, t0, f0) = t0
dnn2(F, x, y) = S(dnn(sub(x, y), y))
dnn2(T, x, y) = Z
hailstone(S(x)) = hailstone2(x, Nil)
hailstone2(S(x), tail) = hailstone2(hsnext(S(x)), Cons(S(S(x)), tail))
hailstone2(Z, tail) = Cons(S(Z), tail)
hslengths2(S(cnt), x, lenlist) = hslengths2(cnt, S(x), Cons(len(hailstone(x)), lenlist))
hslengths2(Z, x, lenlist) = lenlist
isn(N(x)) = T
isn(S(x)) = F
isn(Z) = F
isz(N(x)) = F
isz(S(x)) = F
isz(Z) = T
len(Cons(hd, tl)) = S(len(tl))
len(Nil) = Z
listup(Cons(hd, tl)) = Cons(Cons(hd, Nil), listup(tl))
listup(Nil) = Nil
maybehead(Cons(hd, tl)) = hd
maybehead(Nil) = Nil
maybetake(Cons(hd, tl), x, dst) = takehelper(x, tl, Cons(hd, dst))
maybetake(Nil, x, dst) = dst
merge(Cons(hd, tl), b) = merge2(b, hd, tl)
merge(Nil, b) = b
merge2(Cons(hdb, tlb), hda, tla) = cnd(lss(hda, hdb), Cons(hda, merge2(tla, hdb, tlb)), Cons(hdb, merge2(tlb, hda, tla)))
merge2(Nil, hda, tla) = Cons(hda, tla)
mul(N(x), y) = neg(mul(x, y))
mul(S(x), y) = add(y, mul(x, y))
mul(Z, y) = Z
neg(N(x)) = x
neg(S(x)) = N(S(x))
neg(Z) = Z
sgn(N(x)) = N(S(Z))
sgn(S(x)) = S(Z)
sgn(Z) = Z
snn(S(x), y) = sud(y, x)
snn(Z, y) = neg(y)
sortiters(Cons(hd, tl)) = sortiters2(tl, hd)
sortiters(Nil) = Nil
sortiters2(Cons(hd2, tl), hd) = sortiters(Cons(merge(hd, hd2), sortiters(tl)))
sortiters2(Nil, hd) = Cons(hd, Nil)
sud(S(y), x) = snn(x, y)
sud(Z, x) = S(x)
sup(N(x), y) = N(aup(y, x))
sup(S(x), y) = sud(y, x)
sup(Z, y) = N(y)
takehelper(S(x), src, dst) = maybetake(src, x, dst)
takehelper(Z, src, dst) = dst
pushback(Nil, x) = Cons(x, Nil)
pushback(Cons(hd, tl), x) = Cons(hd, pushback(tl, x))
concat(lhs, rhs) = concatrev(rhs, lhs)
concatrev(Nil, lhs) = lhs
concatrev(Cons(hd, tl), lhs) = concatrev(tl, pushback(lhs, hd))
octa(x) = Octa(x, x, x, x, x, x, x, x)
second(x, y) = y
forever() = forever()
.
take(mul(S(S(S(Z))), S(S(S(S(S(Z)))))), sort(hslengths(mul(S(S(orderOfMagnitude)), S(S(S(S(S(Z)))))))))
